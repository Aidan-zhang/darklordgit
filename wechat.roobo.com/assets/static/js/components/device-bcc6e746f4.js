configvm=new Vue({el:"#j_config",data:{info:"",firmware:"",isonline:!0,num:0,newversion:!1},computed:{canupdate:function(){return!!this.isonline&&!(this.firmware.electricity<50)}},ready:function(){this.getinfo(),this.getlistnum(),this.getver()},methods:{getlistnum:function(){var e=this;$.ajax({url:juli.URL.getplaytracklist,type:"get",dataType:"json",cache:!1,data:{deviceId:utils.getdevice()}}).done(function(i){$.each(i,function(i,t){e.num+=t.downloadTrackCount})})},getver:function(){var e=this;$.ajax({url:juli.URL.getversion,type:"get",async:!1,cache:!1,data:{deviceId:utils.getdevice()}}).done(function(i){console.log(i),e.firmware=i,e.info.firmwareVersion<e.firmware[0]&&(e.newversion=!0,clientCreate(onConnectCallback))})},update:function(){var e=this;$.confirm("将升级故事机软件，请保证您在故事机旁边，升级过程中不要关机或断开网络。",function(){e.updatefun()},function(){return!1})},updatefun:function(){var e=this;boxUpgrade(e.firmware[0],e.firmware[1]),e.canupdate=!1},getinfo:function(){var e=this;utils.online()||($.toptip("故事机不在线！",6e5,"warning"),e.isonline=!1),$.ajax({url:juli.URL.getinfo,type:"get",async:!1,cache:!1,data:{deviceId:utils.getdevice()}}).done(function(i){console.log(i),i.id=i.id.split("_")[0],i.cardAvailable=i.cardAvailable+"MB/",i.cardTotal=i.cardTotal+"MB",i.electricity>100?i.electricity="正在充电":i.electricity+"%",e.info=i})}}});