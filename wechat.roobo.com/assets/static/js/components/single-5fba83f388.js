singlevm=new Vue({el:"#j_single",ready:function(){this.getdata()},methods:{getdata:function(){var t=this;$.ajax({url:juli.URL.getsingle+"/"+utils.getparam("id"),type:"get",dataType:"json",cache:!1}).done(function(e){e.islike=!1,e.isplay=!1,e.trackId=e.id,e.title=e.name,e.duration=e.length,e.sec=utils.formatSeconds(e.length),singlevm.$data=e,utils.settitle(t.name)})},"try":function(){var t=document.getElementById("try");t.play(),this.isplay=!0},stoptry:function(){var t=document.getElementById("try");t.pause(),this.isplay=!1},demand:function(){if(!utils.getdevice())return $.alert("您还没有绑定设备，请去绑定设备！","",function(){}),!1;var t={deviceId:utils.getdevice(),openId:utils.openid,trackId:this.trackId,title:this.name,duration:this.length,url:this.content,downloadUrl:this.content,downloadSize:this.size};$.ajax({url:juli.URL.play+"?mediaId=",type:"POST",contentType:"application/json",async:!1,timeout:4e3,data:JSON.stringify(t),success:function(t){"ok"==t?$.toast("点播成功，请点击故事机上的播放按钮","text"):$.toast("点播失败","text")}})},addfav:function(){if(!utils.getdevice())return $.alert("您还没有绑定设备，请去绑定设备！","",function(){}),!1;var t=this,e={openId:utils.openid,trackId:t.id,title:t.name,duration:t.length,url:t.content,downloadUrl:t.content,downloadSize:t.size};$.ajax({url:juli.URL.addlike,type:"post",contentType:"application/json",data:JSON.stringify(e)}).done(function(e){$.toast("已添加收藏","text"),t.islike=!0})},dellike:function(){var t=this,e={trackId:t.id,openId:utils.openid};$.ajax({url:juli.URL.dellike,type:"post",cache:!1,async:!1,contentType:"application/json",data:JSON.stringify(e)}).done(function(e){$.toast("删除收藏","text"),t.islike=!1})},download:function(t){if(!utils.getdevice())return $.alert("您还没有绑定设备，请去绑定设备！","",function(){}),!1;var e=[{title:this.name,id:this.id,duration:this.length,url:this.content,downloadUrl:this.srcurl,downloadSize:this.size}];$.ajax({url:juli.URL.download+"?deviceId="+utils.getdevice()+"&id="+utils.trackListId()+"&name="+encodeURI(encodeURI(utils.tracklist)),type:"post",contentType:"application/json",data:JSON.stringify(e)}).done(function(t){$.toast("添加成功！","text")})}}});