listdetailvm=new Vue({el:"#j_list",ready:function(){this.getlist()},data:{pagenum:1,imghost:"http://dwn.roo.bo/appimg/",listdata:""},computed:{haspage:function(){return this.listdata.resourcePage.result.length<this.listdata.resourcePage.totalRows}},methods:{getlist:function(){var t=this;$.ajax({url:juli.URL.subcate+"/"+utils.getparam("id")+"/"+t.pagenum+"/"+utils.pagesize,type:"get",dataType:"json",cache:!1}).done(function(e){e.resourcePage.result&&$.each(e.resourcePage.result,function(t,e){e.sec=utils.formatSeconds(e.length),e.isplay=!1,e.islike=!1,e.isexpand=!1}),t.listdata=e,utils.settitle(t.listdata.currentCategory.name)})},getdetail:function(t){var e=this;$.ajax({url:juli.URL.subcate+"/"+t.id+"/"+e.pagenum+"/"+utils.pagesize,type:"get",dataType:"json",cache:!1}).done(function(t){$.each(t.resourcePage.result,function(t,e){e.sec=utils.formatSeconds(e.length),e.isplay=!1,e.islike=!1,e.isexpand=!1}),e.listdata=t,utils.settitle(e.listdata.currentCategory.name)})},nextpage:function(){var t=this;t.pagenum=t.pagenum+1,$.ajax({url:juli.URL.subcate+"/"+t.listdata.currentCategory.id+"/"+t.pagenum+"/"+utils.pagesize,type:"get",dataType:"json",cache:!1}).done(function(e){$.each(e.resourcePage.result,function(t,e){e.sec=utils.formatSeconds(e.length),e.islike=!1,e.isexpand=!1}),$.each(e.resourcePage.result,function(e,a){a.isplay=!1,t.listdata.resourcePage.result.push(a)})})},toggleopen:function(t){$.each(this.listdata.resourcePage.result,function(t,e){e.isexpand=!1}),t.isexpand=!t.isexpand},"try":function(t){$.each(this.listdata.resourcePage.result,function(t,e){e.isplay=!1});var e=document.getElementById("try");e.src=t.content,e.play(),t.isplay=!0,e.onended=function(){t.isplay=!1}},stoptry:function(t){var e=document.getElementById("try");e.pause(),t.isplay=!1},demand:function(t){if(!utils.getdevice())return $.alert("您还没有绑定设备，请去绑定设备！","",function(){}),!1;var e={openId:utils.openid,trackId:t.id,deviceId:utils.getdevice(),duration:t.length,downloadSize:t.size,title:t.name,albumTitle:""};$.ajax({url:juli.URL.play+"?mediaId=",type:"POST",contentType:"application/json",async:!1,timeout:4e3,data:JSON.stringify(e),success:function(t){"ok"==t?$.toast("点播成功，请点击故事机上的播放按钮","text"):$.toast("点播失败","text")}})},addfav:function(t){if(!utils.getdevice())return $.alert("您还没有绑定设备，请去绑定设备！","",function(){}),!1;var e={openId:utils.openid,trackId:t.id,title:t.name,duration:t.length,url:t.content,downloadUrl:t.content,downloadSize:t.size};$.ajax({url:juli.URL.addlike,type:"post",contentType:"application/json",data:JSON.stringify(e)}).done(function(e){$.toast("已添加收藏","text"),t.islike=!0})},dellike:function(t){var e={trackId:t.id,openId:utils.openid};$.ajax({url:juli.URL.dellike,type:"post",cache:!1,async:!1,contentType:"application/json",data:JSON.stringify(e)}).done(function(e){$.toast("删除收藏","text"),t.islike=!1})},download:function(t){if(!utils.getdevice())return $.alert("您还没有绑定设备，请去绑定设备！","",function(){}),!1;var e=this,a=[{title:t.name,id:t.id,duration:t.length,albumTitle:e.listdata.currentCategory.name,albumCoverSmallUrl:e.listdata.currentCategory.imgSmall,url:t.content,downloadUrl:t.srcurl,downloadSize:t.size}];$.ajax({url:juli.URL.download+"?deviceId="+utils.getdevice()+"&id="+utils.trackListId()+"&name="+encodeURI(encodeURI(utils.tracklist)),type:"post",async:!1,contentType:"application/json",data:JSON.stringify(a)}).done(function(t){$.toast("添加成功！","text")})}}});