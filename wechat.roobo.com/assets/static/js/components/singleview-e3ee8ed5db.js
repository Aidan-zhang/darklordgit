function onConnectCallback(){queryTrack(),queryPlayStatus(),queryMode()}function playStatus_change(e){"playing"==e?singleview.isplay=!0:singleview.isplay=!1}function playTrack_change(e,t,n){"-1"==t?singleview.title="当前无正在播放歌曲~":singleview.getsingle(t)}function mode_change(e){var t=singleview;"repeat all"==e?(t.isloop=!0,$.toast("当前循环模式为:全部循环~","text")):(t.isloop=!1,$.toast("当前循环模式为:单曲循环~","text"))}function onlineStatus_change(e){return"on"!=e&&"online"!=e&&"on-upgrade-failed"!=e?(singleview.deviceOnline=!1,$.toast("故事机断网了哦~","text"),!1):void(singleview.deviceOnline=!0)}singleview=new Vue({el:"#j_singleview",ready:function(){this.getdevice(),this.getdeviceinfo()},data:{isplayed:!1,currentdata:"",islike:"",isloop:"",isplay:!1,trackId:"",sec:"",title:"",deviceOnline:!0},methods:{getdevice:function(){utils.getdevice()},getdeviceinfo:function(){var e=this;return e.deviceOnline?void clientCreate(onConnectCallback):($.toast("故事机不在线","text"),!1)},getsingle:function(e){var t=this;$.ajax({url:juli.URL.getsingle+"/"+e,type:"get",dataType:"json",cache:!1}).done(function(e){e||$.alert("已经没有更多歌曲了哦~","",function(){return!1}),t.currentdata=e,t.title=t.currentdata.name,t.sec=utils.formatSeconds(t.currentdata.length),t.$set("islike",!1)})},play:function(){var e=this;return e.deviceOnline?1==e.isplayed?(resumeTrack(),!1):void $.ajax({url:juli.URL.getsingle+"/"+utils.getparam("id"),type:"get",dataType:"json",cache:!1}).done(function(t){var n=parseInt(utils.getparam("id")),i=utils.trackListId(),a=t.content,o=t.content;playTrack(i,n,a,o),e.isplay=!0,e.isplayed=!0}):($.toast("故事机不在线","text"),!1)},pause:function(){var e=this;return e.deviceOnline?(pauseTrack(),void(this.isplay=!1)):($.toast("故事机不在线","text"),!1)},repeatone:function(){var e=this;return e.deviceOnline?(setRepeatone(),void(this.isloop=!0)):($.toast("故事机不在线","text"),!1)},repeatall:function(){var e=this;return e.deviceOnline?(setRepeatall(),void(this.isloop=!1)):($.toast("故事机不在线","text"),!1)},forward:function(){var e=this;return e.deviceOnline?void forwardTrack():($.toast("故事机不在线","text"),!1)},backward:function(){var e=this;return e.deviceOnline?void backwardTrack():($.toast("故事机不在线","text"),!1)},addfav:function(){if(!utils.getdevice())return $.alert("您还没有绑定设备，请去绑定设备！","",function(){}),!1;var e=this,t={openId:utils.openid,trackId:e.currentdata.id,title:e.currentdata.name,duration:e.currentdata.length,url:e.currentdata.content,downloadUrl:e.currentdata.content,downloadSize:e.currentdata.size};$.ajax({url:juli.URL.addlike,type:"post",contentType:"application/json",data:JSON.stringify(t)}).done(function(t){$.toast("已添加收藏","text"),e.islike=!0})},dellike:function(){var e=this,t={trackId:e.currentdata.id,openId:utils.openid};$.ajax({url:juli.URL.dellike,type:"post",cache:!1,async:!1,contentType:"application/json",data:JSON.stringify(t)}).done(function(t){$.toast("删除收藏","text"),e.islike=!1})}}});